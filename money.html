<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>è‡ªç”±ã«ä½¿ãˆã‚‹ãŠé‡‘è¨ˆç®—</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<header>
  <h1>è‡ªç”±ã«ä½¿ãˆã‚‹ãŠé‡‘è¨ˆç®—</h1>
  <a href="index.html">â† ãƒˆãƒƒãƒ—ã«æˆ»ã‚‹</a>
</header>

<main>
  <div class="form">
    <label>æœˆåï¼ˆæ‰‹å–ã‚Šï¼‰
      <input id="income" type="number" placeholder="ä¾‹ï¼š250000">
    </label>

    <h3>æ”¯å‡ºé …ç›®</h3>
    <div id="items"></div>

    <button onclick="addItem()">ï¼‹ é …ç›®ã‚’è¿½åŠ </button>
    <button onclick="calc()">è¨ˆç®—ã™ã‚‹</button>
  </div>

  <div id="result" class="result"></div>

  <div id="share" style="display:none;">
    <p>ã“ã®çµæœã‚’ã‚·ã‚§ã‚¢</p>
    <button onclick="shareX()">Xã§ã‚·ã‚§ã‚¢</button>
    <button onclick="shareLine()">LINEã§ã‚·ã‚§ã‚¢</button>
    <button onclick="copyText()">ã‚³ãƒ”ãƒ¼</button>
  </div>
</main>

<script>
function addItem() {
  const div = document.createElement("div");
  div.className = "item";

  div.innerHTML = `
    <input class="name" placeholder="ä¾‹ï¼šå®¶è³ƒ">
    <input class="price" type="number" placeholder="é‡‘é¡">
    <button onclick="this.parentElement.remove()">Ã—</button>
  `;

  document.getElementById("items").appendChild(div);
}

function calc() {
  const income = Number(document.getElementById("income").value);
  const prices = document.querySelectorAll(".price");

  let total = 0;
  prices.forEach(p => {
    total += Number(p.value);
  });

  const free = income - total;

  let msg = `æ¯æœˆè‡ªç”±ã«ä½¿ãˆã‚‹ãŠé‡‘ï¼šÂ¥${free.toLocaleString()}`;

  if (free < 0) {
    msg += "<br>âš  åæ”¯ãŒãƒã‚¤ãƒŠã‚¹ã§ã™";
  } else if (free < 30000) {
    msg += "<br>âš  ã‹ãªã‚Šã‚®ãƒªã‚®ãƒªã§ã™";
  } else {
    msg += "<br>ğŸ˜Š ä½™è£•ãŒã‚ã‚Šã¾ã™";
  }

  document.getElementById("result").innerHTML = msg;
  document.getElementById("share").style.display = "block";
}

function makeShareText() {
  const result = document.getElementById("result").innerText;
  return `ã€è‡ªç”±ã«ä½¿ãˆã‚‹ãŠé‡‘è¨ºæ–­ã€‘\n${result}\n`;
}

function shareX() {
  const text = makeShareText();
  const url = location.href;
  window.open(
    `https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(url)}`,
    "_blank"
  );
}

function shareLine() {
  const text = makeShareText();
  const url = location.href;
  window.open(
    `https://social-plugins.line.me/lineit/share?text=${encodeURIComponent(text)}&url=${encodeURIComponent(url)}`,
    "_blank"
  );
}

function copyText() {
  const text = makeShareText();
  navigator.clipboard.writeText(text);
  alert("ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼");
}

// æœ€åˆã‹ã‚‰1è¡Œå‡ºã—ã¦ãŠã
addItem();
</script>

</body>
</html>
